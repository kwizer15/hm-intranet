{% extends "::base.html.twig" %}

{% block title %}JLM{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('bundles/jlmdefault/css/bootstrap.min.css') }}" type="text/css">
	<link rel="stylesheet" href="{{ asset('bundles/jlmdefault/css/bootstrap-responsive.min.css') }}" type="text/css">
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" type="text/css">
	<link rel="stylesheet" href="{{ asset('bundles/jlmdefault/css/style.css') }}" type="text/css">
{% endblock %}

{% block body %}
    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
	        <div class="container">
	      {% block header %}
	      {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
	      	<a href="{{ path('default') }}" class="brand">JLM</a>
			<ul class="nav">
			  {% block navigation %}
			    <li><a href="{{ path('trustee') }}">Saisie</a></li>
		        <li class="dropdown">
		        	<a href="#" class="dropdown-toggle" data-toggle="dropdown">Bureau <b class="caret"></b></a>
		        	<ul class="dropdown-menu">
                        <li class="dropdown-submenu">
		        			<a tabindex="-1" href="{{ path('quote') }}">Devis</a>
		        			<ul class="dropdown-menu">
		        				<li class="dropdown-submenu">
		        					<a tabindex="-1" href="{{ path('askquote') }}">Demandes</a>
		        					<ul class="dropdown-menu">
		        						<li><a href="{{ path('askquote_new') }}"><i class="icon-plus-sign"></i> Nouvelle demande de devis</a></li>
		        						<li class="divider"></li>
		        						{% render "JLMOfficeBundle:Askquote:sidebar" %}
		        					</ul>
		        				</li>
		        				<li class="divider"></li>
		        				{% render "JLMOfficeBundle:Quote:sidebar" %}
		        			</ul>
		        		</li>
		        		<li class="dropdown-submenu">
		        			<a tabindex="-1" href="{{ path('order') }}">Fiches travaux</a>
		        			<ul class="dropdown-menu">
		        			{#	<li><a href="{{ path('order_new') }}"><i class="icon-plus-sign"></i> Nouvelle fiche</a></li>
								<li class="divider"></li> #}
				        		{% render "JLMOfficeBundle:Order:sidebar" %} 
		        			</ul>
		        		</li>
                        <li class="dropdown-submenu">
		        			<a tabindex="-1" href="{{ path('bill') }}">Facture</a>
		        			<ul class="dropdown-menu">
				        		<li><a href="{{ path('bill_new') }}"><i class="icon-plus-sign"></i> Nouvelle facture</a></li>
				        		<li class="divider"></li>
				        		{% render "JLMOfficeBundle:Bill:sidebar" %}
		        			</ul>
		        		</li>
                        <li class="dropdown-submenu">
		        			<a tabindex="-1" href="{{ path('fees') }}">Redevances</a>
		        			<ul class="dropdown-menu">
		        				<li><a href="{{ path('fees') }}"><i class="icon-list"></i> Liste</a></li>
		        			</ul>
		        		</li>
		        	</ul>
		        </li>
		        <li><a href="{{ path('intervention_today') }}">Journal de bord</a></li>
		        <li class="dropdown">
		            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Etats <b class="caret"></b></a>
		        	<ul class="dropdown-menu">
		        		<li><a href="{{ path('state_top') }}">Top dépannage</a></li>
		        		<li><a href="{{ path('state_technicians') }}">Techniciens</a></li>
		        		<li><a href="{{ path('state_maintenance') }}">Entretiens</a></li>
		        	</ul>
		        </li>
			  {% endblock navigation %}
			</ul>
			<div class="btn-group pull-right">
			   <a href="#" class="btn btn-info dropdown-toggle" data-toggle="dropdown"><i class="icon-user  icon-white"></i> {{ app.user.person.firstName }} <b class="caret"></b></a>
			   <ul class="dropdown-menu">
			   		<li><a href="{{ path('fos_user_security_logout') }}"><i class="icon-remove-sign"></i> Déconnexion</a></li>
			   		<li class="divider"></li>
			   		<li><a href="{{ path('fos_user_profile_show') }}"><i class="icon-user"></i> Mon profil</a></li>
			   		<li><a href="{{ path('fos_user_change_password') }}"><i class="icon-lock"></i> Changer mon mot de passe</a></li>  		
			   </ul>
			</div>
			{% endif %}	
	      {% endblock header %}
	          </div>
	      </div>
      </div>   
      <div class="container-fluid">
		  {% block container %}
		  {% endblock container %}
      </div>
      <footer>
          {% block footer %}
          {% endblock footer %}
      </footer>
{% endblock body%}

{% block javascripts %}
    <script src="http://code.jquery.com/jquery-2.0.0.js"></script>
    <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
    <script src="{{ asset("bundles/jlmdefault/js/bootstrap.js") }}"></script>
    <script src="{{ asset("bundles/jlmdefault/js/jquery.ui.datepicker-fr.js") }}"></script>
    <script src="{{ asset("bundles/jlmdefault/js/number_format.js") }}"></script>
<script>
$('.autocompletion').autocomplete({
	source : function(request,response){
		return $.post(
			this.element.attr('data-source'),
			request, 
			function (data) { response(data);},
			'json'
		);
    },
    items:12,
});
{# z-index pour appartition dans une modal #}
$('.datepicker').datepicker({
	dateFormat:'dd/mm/yy',
});
$('.datepicker').datepicker( "option",
        $.datepicker.regional[ "fr" ] );

$(".input-money").on('change',function(){
	$(this).val(
		number_format(
			parseFloat(
				$(this).val()
				       .replace(',','.')
				       .replace(/[\s]{1,}/g,"")
			),2,',',' '
		)
	);
	return this;
});
</script>
{% endblock javascripts %}

{% block javascriptappend %}
<script>
$('.ui-autocomplete, .modal .datepicker').css('z-index','10000');
</script>
{% endblock %}
