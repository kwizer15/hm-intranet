{% extends "JLMOfficeBundle::layout.html.twig" %}
{% form_theme edit_form with 'JLMOfficeBundle:Form:quote.html.twig' %}
{% block content %}
<h1>Edition d'un devis <small>{{ entity.number }}</small></h1>
{% if form_errors(edit_form) %}
<div class="alert">{{ form_errors(edit_form) }}</div>
{% endif %}
<div class="row-fluid">
    <div class="span5">
        <strong>Suivi par {{ entity.quote.followerCp }}</strong>
        <br>{{ entity.quote.doorCp | nl2br }}
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Devis n°</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{ entity.quote.creation|date('d/m/Y') }}</td>
                    <td>{{ entity.quote.number }}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="span5 offset2 well">
        {{ entity.quote.trusteeName }}
        <br>{{ entity.quote.trusteeAddress | nl2br  }}
        <br>
        <br>à l'attention de {{ entity.quote.contactCp }}
    </div>
</div>
<form action="{{ path('variant_update', { 'id' : entity.id}) }}" method="post" {{ form_enctype(edit_form) }} class="form-horizontal">
  <fieldset>
  <input type="hidden" value="{{ (entity.quote.vat*100) | number_format(1,',',' ') }}" id="quote_vat">
  <input type="hidden" value="{{ (entity.quote.vatTransmitter*100) | number_format(1,',',' ') }}" id="quote_vatTransmitter">
    {{ form_widget(edit_form) }}
	<div class="form-actions">
	  <a href="{{ path('quote_show', { 'id' : entity.quote.id }) }}" class="btn"><i class="icon-arrow-left"></i> Retour au devis</a>
	  <button type="submit" class="btn btn-primary"><i class="icon-pencil icon-white"></i> Enregistrer les modifications</button>
	</div>
  </fieldset>
</form>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script src="{{ asset("bundles/jlmoffice/js/quote.js") }}"></script>
<script>
$("body").quotevariant({
	 autoSource:'{{ path('autocomplete') }}',
	 lineCount:{{ edit_form.lines | length }}
});
</script>
{% endblock %}